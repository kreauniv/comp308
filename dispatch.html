<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Polymorphism via dispatch &#8212; Comp308: Principles of Programming Languages v1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=3d3fbe02" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5cb08e4e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Alternative application semantics" href="appsem.html" />
    <link rel="prev" title="On the choice between “error” and “do something reasonable” in design" href="errornot.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="polymorphism-via-dispatch">
<h1>Polymorphism via dispatch<a class="headerlink" href="#polymorphism-via-dispatch" title="Link to this heading">¶</a></h1>
<p>(IN DRAFT)</p>
<p>Note: This section is expected to supercede the discussion on <span class="xref std std-doc">objects</span>.</p>
<p>When writing our procedures/functions in a programming language, we deal with
different data structures and entities such as files, network sockets and
processes. For any given system, a number of such entities serves as its “API”
or “Application Programming Interface”. If each of these entities were to be
transacted with using its own vocabulary, it will become very hard for
programmers to retain the vocabularies necessary to work with a practical
subset of these entity types in working memory so they act of programming is
both efficient and reliable.</p>
<p>Thankfully, many of these entities can be worked with using a much smaller set
of “verbs” using which programmers typically chunk their thinking about them.
For example, both hash-tables and vectors in Racket offer the notion of
associating a value with a key. Only, in the case of hash-tables, the key can be
anything “hashable” whereas in the case of a vector, the key must be in the
range <span class="math notranslate nohighlight">\([0,N)\)</span>. However, the act of getting a value associated with a
particular key can simply be thought of across all such data structures using
the verb “get” and similarly the setting of a value against a particular key can
be thought of using the verb “set”.</p>
<p>For an analogy, consider the Harry Potter world and Hermione Granger’s timely
use of the spell “Alohamora” to open a lock. Suppose that in the wizarding
world, each kind of lock required a different spell to be learnt to open it –
“Alohamora Big One”, “Alohamora 42”, “Alohamora Locksmith &amp; Sons Tiny 2021
edition” and so on – wizards might give up pretty soon. But we have a hint
here – that the word “Alohamora” suggests that the lock needs to be opened,
and the ones programming these locks can determine what to do when the lock
hears the spell “Alohamora”, instead of making custom spells for it. This would
then obviously be preferrable for wizards (and students!) since they would then
need to remember far fewer spells overall to be effective in their world.</p>
<p>Racket library functions kind of work as though they were in that complicated
world of spells. In Racket, though you’ll find procedures named according to
such common vocabulary, each data structure carries its own set of procedures
to work with it. So vectors come with <code class="docutils literal notranslate"><span class="pre">vector-ref</span></code> and <code class="docutils literal notranslate"><span class="pre">vector-set!</span></code> and
<code class="docutils literal notranslate"><span class="pre">vector-length</span></code>, and similarly hash-tables have <code class="docutils literal notranslate"><span class="pre">hash-ref</span></code>,
<code class="docutils literal notranslate"><span class="pre">hash-set!</span></code> and <code class="docutils literal notranslate"><span class="pre">hash-count</span></code>. If we were to invent another data
structure, say, <code class="docutils literal notranslate"><span class="pre">treemap</span></code>, then we’ll have to expose yet more procedures
named <code class="docutils literal notranslate"><span class="pre">treemap-ref</span></code>, <code class="docutils literal notranslate"><span class="pre">treemap-set!</span></code> and <code class="docutils literal notranslate"><span class="pre">treemap-length</span></code> that will do
analogous things with tree maps. If we choose completely different vocabularies
– say, <code class="docutils literal notranslate"><span class="pre">treemap-search-and-retrieve</span></code>, <code class="docutils literal notranslate"><span class="pre">treemap-find-and-replace</span></code> and
<code class="docutils literal notranslate"><span class="pre">treemap-count-entries</span></code> – we’d place a huge cognitive burden on programmers
who’d want to adopt our new data structure since they cannot reuse their
vocabulary in the new context.</p>
<p>What if we could simply say <code class="docutils literal notranslate"><span class="pre">ref</span></code>, <code class="docutils literal notranslate"><span class="pre">set!</span></code> and <code class="docutils literal notranslate"><span class="pre">length</span></code> and when we
introduce a new data structure, be able to declare how these verbs should work
with it at that point? That way, if we have a vector <code class="docutils literal notranslate"><span class="pre">v</span></code>, we reference its
<code class="docutils literal notranslate"><span class="pre">k</span></code>-th element using <code class="docutils literal notranslate"><span class="pre">(ref</span> <span class="pre">v</span> <span class="pre">k)</span></code> and if we have a hashtable <code class="docutils literal notranslate"><span class="pre">h</span></code> and a key
<code class="docutils literal notranslate"><span class="pre">k</span></code>, we can get its associated value using <code class="docutils literal notranslate"><span class="pre">(ref</span> <span class="pre">h</span> <span class="pre">k)</span></code> as well, instead of
<code class="docutils literal notranslate"><span class="pre">(hash-ref</span> <span class="pre">h</span> <span class="pre">k)</span></code>. It is quite evident that the cognitive burden is lower for
such a unified concept of “<code class="docutils literal notranslate"><span class="pre">ref</span></code>-ing” a value. This “reuse of verbs” with
different objects is the essence of “polymorphism”.</p>
<p>While doing this makes for concise code while writing, we also notice that when
reading code, <code class="docutils literal notranslate"><span class="pre">(ref</span> <span class="pre">h</span> <span class="pre">k)</span></code> tells us very little about <code class="docutils literal notranslate"><span class="pre">h</span></code> than “something we
can call <code class="docutils literal notranslate"><span class="pre">ref</span></code> on”, whereas <code class="docutils literal notranslate"><span class="pre">(hash-ref</span> <span class="pre">h</span> <span class="pre">k)</span></code> is amply clear. This is part
of the reason for that design choice to be explicit in the Scheme/Racket
languages. The goal of a program is only partly to instruct machines (such as
“locks”) but equally to communicate “how to” knowledge to other humans.</p>
<div class="admonition-terminology admonition">
<p class="admonition-title"><strong>Terminology</strong></p>
<p>Such a multi-purpose definition of a verb like <code class="docutils literal notranslate"><span class="pre">ref</span></code> and <code class="docutils literal notranslate"><span class="pre">set!</span></code> is
referred to in programming languages as “polymorphism” and the verb is said
to be “polymorphic” over a collection of types.</p>
</div>
<section id="exploring-through-property-lists">
<h2>Exploring through “property lists”<a class="headerlink" href="#exploring-through-property-lists" title="Link to this heading">¶</a></h2>
<p>We’ll explore the design space of object oriented programming languages
through a basic structure called a “property list”, which we’ll assume
that our interpreter has access to at any point (i.e. globally).</p>
<p>A property list is a simple structure that asserts connections between
“subjects”, “objects” (not to be confused with “object” in the OOP sense, but
linguistic “object”) via “predicates”. For example, the triple <code class="docutils literal notranslate"><span class="pre">(Tri</span>
<span class="pre">child23</span> <span class="pre">'mother</span> <span class="pre">adult42)</span></code> establishes that the <code class="docutils literal notranslate"><span class="pre">'mother</span></code> of
<code class="docutils literal notranslate"><span class="pre">child23</span></code> is <code class="docutils literal notranslate"><span class="pre">adult42</span></code>. This relationship can be thought of as a
labelled arrow from the child to the adult. This way, arbitrary graphs can be
represented using such a triple store.</p>
<figure class="align-center" id="id2">
<img alt="A node-edge graph illustrating connections between a node representing a child and three nodes representing adults related to the child." src="_images/triple-store.png" />
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">A triple store can be seen as a graph.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We’ll now model several “object orientedness” ideas based on such a triple
store. Note that this is not to say that such a triple store is what is
backing the various object systems. Far from it. We’re using the plist as a
way to explore the design space and options we have when we’re interested in
minimizing the vocabulary we use to program.</p>
<p>In this chapter, we use the <code class="docutils literal notranslate"><span class="pre">plist.rkt</span></code> module which you can include
using <code class="docutils literal notranslate"><span class="pre">(require</span> <span class="pre">&quot;./plist.rkt&quot;)</span></code> from your own code.</p>
<p>We’ll assume that we’re working with a global plist. Furthermore, we’ll
dispense with implementing it in our language’s interpreter and do it in
plain Racket, since the translation process should now be familiar and
simple to perform.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">require</span><span class="w"> </span><span class="s2">&quot;./plist.rkt&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">plist</span><span class="w"> </span><span class="p">(</span><span class="n">make-plist</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">value</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">set!</span><span class="w"> </span><span class="n">plist</span><span class="w"> </span><span class="p">(</span><span class="n">plist-assert</span><span class="w"> </span><span class="n">plist</span><span class="w"> </span><span class="n">think</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">value</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="n">plist-find</span><span class="w"> </span><span class="n">plist</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="no">#f</span><span class="w"> </span><span class="n">Tri-obj</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">empty?</span><span class="w"> </span><span class="nb">values</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="k">begin</span><span class="w"> </span><span class="c1">; What do we do here?</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="nb">values</span><span class="p">))))</span>
</pre></div>
</div>
<p>In the above implementation, we’re assuming that the plist only holds
a single value for a given <code class="docutils literal notranslate"><span class="pre">thing-key</span></code> combination. We’ll relax
this condition later. For now, note that this is a design space option
available.</p>
<p>We’re now faced with the problem of determining what to do when
an associated value for a given thing and key is sought for in
the plist and one is not present. We’ll choose a general way to
deal with this by passing a handler function.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">error-on-not-found</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">key</span><span class="w"> </span><span class="s2">&quot;Property ~s of ~s is not found&quot;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">thing</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p">[</span><span class="n">not-found-handler</span><span class="w"> </span><span class="n">error-on-not-found</span><span class="p">])</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="nb">values</span><span class="w"> </span><span class="p">(</span><span class="n">plist-find</span><span class="w"> </span><span class="n">plist</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="no">#f</span><span class="w"> </span><span class="n">Tri-obj</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">empty?</span><span class="w"> </span><span class="nb">values</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="n">not-found-handler</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="nb">values</span><span class="p">))))</span>
</pre></div>
</div>
<p>We’ll also define a simple structure to make object references.
We’ll give it an <code class="docutils literal notranslate"><span class="pre">id</span></code> field so when printing out an object, we
know its name. There is no other significance to this <code class="docutils literal notranslate"><span class="pre">id</span></code> field.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="n">Obj</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">#:transparent</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="a-prototype-based-object-system">
<h2>A prototype based object system<a class="headerlink" href="#a-prototype-based-object-system" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Self</span></code> language pioneered the idea of a prototype based object system.
Although historically this came after the class based system introduced by
<code class="docutils literal notranslate"><span class="pre">Smalltalk</span></code> as a response to the problem of prematurely having to determine
an application’s architecture based on “classes” that aren’t necessary known
up front and will be discovered along the way. In other words, the prototype
based system was seen as a way to <strong>evolve</strong> software as requirements come in
during its development. The object system in <code class="docutils literal notranslate"><span class="pre">JavaScript</span></code> is based on these
ideas developed in <code class="docutils literal notranslate"><span class="pre">Self</span></code>.</p>
<p>So, what is an “object” in such a system in the first place? In such a
prototype based system, an object is simply a collection of named properties
and “methods”. A “message” to an object involves a “message name” (a.k.a.
“selector”) and some additional arguments. When a message is “sent” to an
object, it looks up a corresponding method (in a table), which is a procedure
and calls the procedure with the given message arguments. Methods also need to
get a reference to the object as well, so they can access other properties and
methods they need.</p>
<div class="admonition-objects-and-state admonition">
<p class="admonition-title"><strong>Objects and state</strong></p>
<p>Note the change of language we’re faced with when looking at such “objects”
– in particular, we’re using an imperative language as though the object
has some internal storage that we can only influence through message
passing and it is free to do anything with that internal data in response
to messages. This “state encapsulation” is a significant by product of
object think and there would be no reason to choose a dominantly object
based design for a system unless it requires and exploits such state
encapsulation to simply using and reasoning about the system.</p>
</div>
<p>So we’ll make a simple function to which we can give a list
of keys and values (including method procedures) and get an object
reference that is associated with those properties and methods.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">kvs</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">obj</span><span class="w"> </span><span class="p">(</span><span class="n">Obj</span><span class="w"> </span><span class="n">id</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="p">([</span><span class="n">kvs</span><span class="w"> </span><span class="n">kvs</span><span class="p">])</span>
<span class="w">            </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">empty?</span><span class="w"> </span><span class="n">kvs</span><span class="p">)</span>
<span class="w">                </span><span class="n">obj</span>
<span class="w">                </span><span class="p">(</span><span class="k">begin</span><span class="w"> </span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="n">kvs</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">second</span><span class="w"> </span><span class="n">kvs</span><span class="p">))</span>
<span class="w">                       </span><span class="p">(</span><span class="n">loop</span><span class="w"> </span><span class="p">(</span><span class="nb">rest</span><span class="w"> </span><span class="p">(</span><span class="nb">rest</span><span class="w"> </span><span class="n">kvs</span><span class="p">))))))))</span>
</pre></div>
</div>
<p>With that definition in hand, we can do the following -</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">dog1</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">puppy</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">brown</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="s2">&quot;Yelp!&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">dog2</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">adult</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">black</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="s2">&quot;Woof Woof!&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">cat1</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">siamese</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">grey</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;I don&#39;t bark! Am I a dog?&quot;</span><span class="p">))))</span>

<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">cat1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">color</span><span class="p">)</span>
<span class="o">&#39;</span><span class="ss">grey</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">dog2</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">color</span><span class="p">)</span>
<span class="o">&#39;</span><span class="ss">black</span>
</pre></div>
</div>
<p>Now, what does it mean to send an object a message? In our case,
we’re modelling “message passing” as “method invocation”. So we
need to take the message name, look it up in the property list
against the object, and call the function associated. For now,
we’ll leave the “no such method” condition as an error.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span>
<span class="w">        </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;Placeholder. Property name not found.&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">procedure?</span><span class="w"> </span><span class="n">method</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;Method must be a procedure&quot;</span><span class="p">))))</span>
</pre></div>
</div>
<p>Now we can make our animals make noises -</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">bark</span><span class="p">)</span>
<span class="n">Yelp!</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">dog2</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">bark</span><span class="p">)</span>
<span class="n">Woof</span><span class="w"> </span><span class="n">Woof!</span>
</pre></div>
</div>
<p>Note that the objects are doing something different though
both have been asked to “bark”. This is pretty much the whole
value behind object oriented programming. Objects are able
to do this because they encapsulate state in the form of
properties.</p>
<p>Now, notice that the <code class="docutils literal notranslate"><span class="pre">cat1</span></code> object errors out when asked
to bark. However, we may think of both cats and dogs as
“four legged animals”. Let’s make an <code class="docutils literal notranslate"><span class="pre">animal</span></code> object that
represents this idea -</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">animal</span><span class="w"> </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Animal</span>
<span class="w">                    </span><span class="o">&#39;</span><span class="ss">num-legs</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>Now, we’d like to have our cats and dogs respond to a request
for <code class="docutils literal notranslate"><span class="pre">'num-legs</span></code> with 4. We can of course add these properties
to each of those objects, but that feels redundant.</p>
<p>Here is where the “Placeholder” gains importance. We left open
the question of what to do when a property is not found. We
can now exploit that gap by asking another linked object for
the property. But which other object? For that, we can look
it up in the property list.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span>
<span class="w">        </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">            </span><span class="c1">; Note the recursive call to &#39;get&#39;</span>
<span class="w">            </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span>
<span class="w">                    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">superkey</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;No such parent&quot;</span><span class="p">)))</span>
<span class="w">                 </span><span class="n">propname</span><span class="p">))))</span>
</pre></div>
</div>
<p>We did something interesting there. We first try to look up a “super” property
of the object, which we expect to be defined to another object. If we find one,
we then ask that object for the property. If such a “super object” doesn’t
exist, the <code class="docutils literal notranslate"><span class="pre">getprop</span></code> will error out. But if it does, it will be as though our
object gained the properties of that “super object”. Now, when getting the
property of the “super”, we do it recursively so that if that “super” also
didn’t have that property or method, we look up its “super” and so on until
either the property/method is found or it errors out.</p>
<p>Note that we’ve again left a placeholder for the condition when the “super” of
an object cannot be found. We’ll return to this choice point later. First let’s
see what this mechanism buys us for our animal farm.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="w"> </span><span class="n">animal</span><span class="p">)</span>
<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">dog2</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="w"> </span><span class="n">animal</span><span class="p">)</span>
<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">cat1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="w"> </span><span class="n">animal</span><span class="p">)</span>

<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">num-legs</span><span class="p">)</span>
<span class="mi">4</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">cat1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">num-legs</span><span class="p">)</span>
<span class="mi">4</span>
</pre></div>
</div>
<p>We can now also add a method dynamically to <code class="docutils literal notranslate"><span class="pre">animal</span></code> and all the
animals will automatically get it.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">animal</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">walk</span>
<span class="w">    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="w"> </span><span class="n">num-steps</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span>
<span class="w">            </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">               </span><span class="n">num-steps</span><span class="p">))))</span>

<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">walk</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span><span class="p">)</span>
<span class="mi">3</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">walk</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">dog1</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span><span class="p">)</span>
<span class="mi">8</span>
</pre></div>
</div>
</section>
<section id="it-s-tiring">
<h2>It’s tiring<a class="headerlink" href="#it-s-tiring" title="Link to this heading">¶</a></h2>
<p>Now, imagine the process we went through just got bigger with many
tens of methods and properties. Every time we make a new object – an
animal – we have to define these properties on each of them. The
ability to delegate commonly accessed methods to such a “super”
object like we just did is therefore a boon since we can just accumulate
those common methods in that “super” object and make the other objects
just reference it via their <code class="docutils literal notranslate"><span class="pre">'super</span></code> property.</p>
<p>This is the essence of how “classes” are modelled in prototype based object
systems. The “super object” of an object is also known as the object’s “class”.</p>
<p>Such prototype based systems do not really distinguish between the notions of
“object methods” versus “class methods”, since these “classes” are themselves
objects and when you send a message via the object, the method actually affects
the object in question and not its class, unless you make the class the target
of the message send. This is due to the methods taking the object as their
first argument usually named <code class="docutils literal notranslate"><span class="pre">self</span></code>, as with Python or <code class="docutils literal notranslate"><span class="pre">this</span></code> as with
JavaScript.</p>
</section>
<section id="class-methods">
<h2>Class methods<a class="headerlink" href="#class-methods" title="Link to this heading">¶</a></h2>
<p>In order to distinguish between “class methods” (methods that operate on the
class) versus “object methods” (methods that operate on the object that
inherits properties and methods from the class), we therefore need to
make that distinction available in the message sending procedure.</p>
<p>So far, we only added the <code class="docutils literal notranslate"><span class="pre">self</span></code> argument. In the <code class="docutils literal notranslate"><span class="pre">send</span></code> procedure, we
first lookup the message in the object hierarchy and then invoke the method on
the object. If we separate the two, we gain the ability to use the methods in
one object and apply then on another. To keep the generality, we need to
augment our method argument list with the object we use to lookup the method as
well so that the method can do what it pleases with that information. The
effect of this is only relevant when we have deeper and/or broader class
hierarchies though.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">send/super</span><span class="w"> </span><span class="k">super</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="k">super</span><span class="w"> </span><span class="n">message</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">procedure?</span><span class="w"> </span><span class="n">method</span><span class="p">)</span>
<span class="w">            </span><span class="c1">; Note the change in protocol for method invocation</span>
<span class="w">            </span><span class="c1">; which now takes an additional &quot;super&quot; argument.</span>
<span class="w">            </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="k">super</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;Method must be a procedure&quot;</span><span class="p">))))</span>

<span class="c1">; Note that in class-based object systems, method lookup</span>
<span class="c1">; starts with an object&#39;s class and not the object itself.</span>
<span class="c1">; So we need to lookup an object&#39;s ``&#39;isa`` property and</span>
<span class="c1">; and invoke ``send/super``.</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="n">send/super</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">isa</span><span class="p">)</span>
<span class="w">                            </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">args</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">dog1</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">puppy</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">brown</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="k">super</span><span class="w"> </span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="s2">&quot;Yelp!&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">dog2</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">adult</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">black</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="k">super</span><span class="w"> </span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">displayln</span><span class="w"> </span><span class="s2">&quot;Woof Woof!&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">cat1</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">siamese</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">color</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">grey</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">bark</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="k">super</span><span class="w"> </span><span class="n">self</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;I don&#39;t bark! Am I a dog?&quot;</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">animal</span>
<span class="w">    </span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Animal</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">num-legs</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="o">&#39;</span><span class="ss">walk</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="k">super</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="n">num-steps</span><span class="p">)</span>
<span class="w">                </span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span>
<span class="w">                    </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">steps-walked</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">                       </span><span class="n">num-steps</span><span class="p">)))))</span>
</pre></div>
</div>
<p>So what new capability does doing this give us? Within a method,
we can now delegate a part of the functionality to the “super”
if we wish. For example, if we want to make a custom “walk” method
for the cat that depends on whether it is tired, we can do this -</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">tired</span><span class="w"> </span><span class="no">#t</span><span class="p">)</span>
<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">walk</span>
<span class="w">    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">klass</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="n">num-steps</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">tired</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="s2">&quot;No energy for a walk. Go away. Meeeow!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="n">send/super</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">klass</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="p">)</span><span class="w"> </span><span class="n">self</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">walk</span><span class="w"> </span><span class="n">num-steps</span><span class="p">))))</span>
</pre></div>
</div>
<p>Notice how the cat delegates to its super the ability to walk when it
is able to, but errors out otherwise. Under normal method invocation,
<code class="docutils literal notranslate"><span class="pre">klass</span></code> will be the same as <code class="docutils literal notranslate"><span class="pre">self</span></code>, but we can choose differently,
just as the method does when turning around and invoking the parent
implementation directly, but without changing the target object.</p>
</section>
<section id="classes-and-types">
<h2>Classes and Types<a class="headerlink" href="#classes-and-types" title="Link to this heading">¶</a></h2>
<p>We saw how the concept of a class arises in a prototype based object
system – mostly to collect a group of related methods that apply
to a set of objects that are said to be “instances” of the same idea.
In our example, the dogs and the cat were instances of “animal”.</p>
<p>Due to this correspondence, such a delegate object (which we called “super”)
can be thought of as the “type” of the object. Languages like C++ and Java
which are class based often take this approach. In these languages,
a class acts like a factory for objects which imbues the objects it
creates with a consistent set of properties and methods.</p>
<p>We can pretty much use the same <code class="docutils literal notranslate"><span class="pre">get</span></code> algorithm with naming the
property lookup <code class="docutils literal notranslate"><span class="pre">class</span></code> instead of <code class="docutils literal notranslate"><span class="pre">super</span></code> and it will start
to look like a class based object system. In such systems though,
the relationship between an object and its class is deemed to be
an “is-a” relationship and it is the class which has a hierarchy
and not the object. When an object is created, it is created with
“slots” for its properties and the methods are all grouped within
the class. The object itself does not maintain a table of methods
but delegates method lookup to its class. We can model this structure
like below –</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">propname</span>
<span class="w">        </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">thing</span><span class="w"> </span><span class="n">propname</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="p">)</span><span class="w"> </span><span class="n">propname</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">klass</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">isa</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="n">send/super</span><span class="w"> </span><span class="p">(</span><span class="nb">append</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="n">klass</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="n">args</span><span class="p">))))</span>
</pre></div>
</div>
</section>
<section id="uniformity-considerations">
<h2>Uniformity considerations<a class="headerlink" href="#uniformity-considerations" title="Link to this heading">¶</a></h2>
<p>We saw that “pure” OOP systems tend to say “everything is an object”
and that “everything happens via message passing”. This includes languages
like Smalltalk, Self and Ruby. Here is, for example, how such a system
might handle branching on a condition.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">True</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">if:else:</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">ctxt</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">thenblock</span><span class="w"> </span><span class="n">elseblock</span><span class="p">)</span>
<span class="w">                                </span><span class="p">(</span><span class="n">thenblock</span><span class="p">)))</span>
<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">False</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">if:else:</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">ctxt</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">thenblock</span><span class="w"> </span><span class="n">elseblock</span><span class="p">)</span>
<span class="w">                                </span><span class="p">(</span><span class="n">elseblock</span><span class="p">)))</span>
</pre></div>
</div>
<p>So the result of a boolean computation is a singleton instance of one of the
“classes” named <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code>, which dispatch on the <code class="docutils literal notranslate"><span class="pre">'if:else:</span></code>
message on one or the other branch depending on which instance received the
message.</p>
<p>Other control constructs are also cleverly constructed based on the fundamental
notion of a “block” - which plays the role of a lambda function in OOP
languages like Ruby and Smalltalk, and are “ordinary” first class functions in
languages like JavaScript and Python. For example, a block object could have
a method named <code class="docutils literal notranslate"><span class="pre">whileTrue:</span></code> which takes another block and runs it repeatedly
until the target block returns with <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>What about ordinary numbers then? Should we declare each number used in the
system to have a property list entry that gives it “class”? That would be terribly
wasteful and impractical to do so. So these systems use a few bits in small
data types like numbers to tell their types, as an implementation hack. In
principle, that is equivalent to having some type checks like below –</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">isa</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="k">cond</span>
<span class="w">            </span><span class="p">[(</span><span class="nb">number?</span><span class="w"> </span><span class="n">thing</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Number</span><span class="p">]</span>
<span class="w">            </span><span class="p">[(</span><span class="nb">string?</span><span class="w"> </span><span class="n">thing</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">String</span><span class="p">]</span>
<span class="w">            </span><span class="p">[(</span><span class="nb">symbol?</span><span class="w"> </span><span class="n">thing</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Symbol</span><span class="p">]</span>
<span class="w">            </span><span class="p">[(</span><span class="nb">boolean?</span><span class="w"> </span><span class="n">thing</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">True</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">False</span><span class="p">)]</span>
<span class="w">            </span><span class="p">[</span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)])</span><span class="w"> </span><span class="c1">; Errors out if not found.</span>
<span class="w">        </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="n">key</span>
<span class="w">            </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="w">                </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">thing</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="p">)</span><span class="w"> </span><span class="n">key</span><span class="p">)))))</span>
</pre></div>
</div>
<p>Now we no longer have to have individual raw data items like numbers
and strings in our property list take just so we can get at their types/classes.</p>
</section>
<section id="flipping-things-around">
<h2>Flipping things around<a class="headerlink" href="#flipping-things-around" title="Link to this heading">¶</a></h2>
<p>We modelled message passing as method invocation using our <code class="docutils literal notranslate"><span class="pre">send</span></code> procedure
which we wrote like this (for prototype based inheritance).</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
</pre></div>
</div>
<p>This puts the object in the centre of the stage and the message plays the role
of something that the object receives and then does something with. We can equivalently
write it as an <code class="docutils literal notranslate"><span class="pre">invoke</span></code> procedure like below, which puts the message
at the centre of the stage.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">invoke</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">method</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
</pre></div>
</div>
<p>They both do the same thing. But now we can ask an interesting question we
might not have asked with the earlier approach – can we now determine which
method to call based on the types/classes of more than one object? This
situation arises often in scientific computing where “what to do” is often only
possible to know when the types of multiple entities are known – such as how
to add a complex number to a real number or multiply a real number with a
vector, and so on.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">gettype</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">type</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">invoke2</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="n">obj2</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="n">gettype</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="n">obj2</span><span class="p">)))</span>
<span class="w">        </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="n">obj2</span><span class="p">)))</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">invoke2</span></code> above, we’re treating the method as the thing for which
we’re looking up properties against various nominal types (i.e. types by
names). The key is a compound object in this case, a list of two types
(which could be symbols). We can now define methods for concatenating
strings and integers perhaps using this approach –</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">add</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Number</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Number</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">n1</span><span class="w"> </span><span class="n">n2</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="n">n2</span><span class="p">)))</span>

<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">add</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">String</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Number</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="n">num</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;~s~s&quot;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="n">num</span><span class="p">)))</span>

<span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">add</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">Number</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">String</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nb">format</span><span class="w"> </span><span class="s2">&quot;~s~s&quot;</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">str</span><span class="p">)))</span>
</pre></div>
</div>
<p>Now we can add number and strings freely. Not that that’s “a good thing”,
but we can.</p>
<p>The interesting thing about this approach is that we’re no longer forced to
determine whether the code for adding a string with a number should go within
the class for strings or the class for numbers! However, it looks like we’ve
traded that flexibility for a whole lot of responsibility – that of specifying
what procedure to use for potentially N^2 type combinations where N is the
number of types in the program. While the problem is not as dire as that, it
does get burdensome even dealing with special methods for combining various
types of numbers. But the payoff is simplicity for the programmer and that is
worth some of the additional work put in to ensure that method names have
consistent interpretations across various types.</p>
<p>This approach is also the essence of “multiple argument dispatch”. We can
obviously extend this approach beyond just 2 arguments. Julia is a programming
language in which this notion of multiple argument dispatch, combined with type
inference and just-ahead-of-time compilation is used to generate highly
efficient code for scientific computing applications. Julia gets around the
problem of having to specify special method implementations for multiple
combinations by permitting the definition of generic methods on which type
inference at call time can produce concrete types and methods at all the call
points and therefore special methods that are consistent with the intent of the
verb can be generated on demand.  For example, consider the following
definition for a “squared distance” -</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">sqdist</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="n">adj</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="n">adj</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="p">)))</span>
</pre></div>
</div>
<p>If we have implementations for different types for <code class="docutils literal notranslate"><span class="pre">adj</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code> and
<code class="docutils literal notranslate"><span class="pre">+</span></code>, this generic way of specifying a computation using those methods
suffices to produce special implementation depending on the context.
For example, if <code class="docutils literal notranslate"><span class="pre">dx</span></code> and <code class="docutils literal notranslate"><span class="pre">dy</span></code> happened to be vectors, we can interpret
<code class="docutils literal notranslate"><span class="pre">sqdist</span></code> to be equivalent to –</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">sqdist-vec-vec</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span>
<span class="w">    </span><span class="c1">; where vec* acts like a dot product when</span>
<span class="w">    </span><span class="c1">; given a row vector and a column vector.</span>
<span class="w">    </span><span class="p">(</span><span class="n">vec+</span><span class="w"> </span><span class="p">(</span><span class="n">vec*</span><span class="w"> </span><span class="p">(</span><span class="n">vec-adj</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="n">vec*</span><span class="w"> </span><span class="p">(</span><span class="n">vec-adj</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">sqdist-complex-complex</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">complex+</span><span class="w"> </span><span class="p">(</span><span class="n">complex*</span><span class="w"> </span><span class="p">(</span><span class="n">complex-conj</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span><span class="w"> </span><span class="n">dx</span><span class="p">)</span>
<span class="w">              </span><span class="p">(</span><span class="n">complex*</span><span class="w"> </span><span class="p">(</span><span class="n">complex-conj</span><span class="w"> </span><span class="n">dy</span><span class="p">)</span><span class="w"> </span><span class="n">dy</span><span class="p">)))</span>

<span class="c1">; and so on.</span>
</pre></div>
</div>
<p>The important simplifying procedure here is that these specialized methods
can be automatically generated from one (or more) generic specifications
depending on need. <a class="footnote-reference brackets" href="#genmethods" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="genmethods" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Providing an implementation of this is not simple and would
fall into the scope of an advanced course that covers the required type
systems and type inference mechanisms.</p>
</aside>
</aside>
<p>In the above <code class="docutils literal notranslate"><span class="pre">invoke2</span></code> procedure, we’re doing dynamic dispatch over multiple
arguments. However, that is not necessary and it is possible to do some of this
analysis at compile time and determine which method procedures to call
statically … which is a huge efficiency boost over determining it for every
pair of, say, numbers over and over again. While Julia can do dynamic dispatch
as a fallback, such a static dispatch is what it relies on for its performance.</p>
<p>In this approach, therefore, a “verb” does not correspond to a single procedure,
but to a family of related procedures called “methods” and which procedure to
use for a particular call is determined based on the types of the arguments
being passed to it.</p>
</section>
<section id="miscellaneous-considerations">
<h2>Miscellaneous considerations<a class="headerlink" href="#miscellaneous-considerations" title="Link to this heading">¶</a></h2>
<section id="initializing-objects">
<h3>Initializing objects<a class="headerlink" href="#initializing-objects" title="Link to this heading">¶</a></h3>
<p>In class based object systems, an object is simply configured to refer to its
class for the methods and is allocated some memory “slots” to store its
properties. Usually though, each kind of object will need to be initialized
with the slots containing values that meet some specific constraints of
consistency. For example, a “Point2D” object may need to have its “x” and “y”
slots be initialized to 0. Such an initialization is done by a designated
method in the class called its “constructor”. This “constructor” procedure is
run only once at object creation time and is not available for use in the
method invocation chain.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">klass</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">obj</span><span class="w"> </span><span class="p">(</span><span class="n">Obj</span><span class="w"> </span><span class="n">klass</span><span class="p">)])</span>
<span class="w">        </span><span class="p">(</span><span class="n">setprop!</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">isa</span><span class="w"> </span><span class="n">klass</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">klass</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">constructor</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">))</span>
<span class="w">        </span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that some languages like Java and C++ enforce different calling forms for
constructors which won’t permit constructor functions to be treated as methods.
This is a language design option and our implementation leaves this enforcement
to later. Python has <code class="docutils literal notranslate"><span class="pre">__init__</span></code> methods that serve this purpose that are
valid as ordinary methods. So it is not uncommon to treat a constructor like an
ordinary method as well.</p>
</section>
<section id="method-not-found">
<h3>Method not found<a class="headerlink" href="#method-not-found" title="Link to this heading">¶</a></h3>
<p>Earlier, we had a case where we had a failure to lookup a method by name
and we errored out. We have another option - to rely on the property list
to figure out what to do! For example, if a “method-not-found” procedure is
defined for a type, we can call that to determine any dynamic actions to
perform.</p>
<div class="highlight-racket notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="k">send</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">([</span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">message</span>
<span class="w">                    </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
<span class="w">                        </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="p">(</span><span class="n">getprop</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">super</span><span class="w"> </span><span class="p">(</span><span class="k">λ</span><span class="w"> </span><span class="p">(</span><span class="n">thing</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="no">#f</span><span class="p">))</span><span class="w"> </span><span class="n">message</span><span class="p">)))])</span>
<span class="w">        </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">method</span>
<span class="w">            </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="n">args</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="p">(</span><span class="n">get</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">method-not-found</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">args</span><span class="p">))))))</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Comp308: Principles of Programming Languages</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Welcome note</a></li>
<li class="toctree-l1"><a class="reference internal" href="racket-intro.html">A quick introduction to Racket and Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html">λ - the everything</a></li>
<li class="toctree-l1"><a class="reference internal" href="church.html">Lambda - via β-abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="piclang.html">A language for pictures</a></li>
<li class="toctree-l1"><a class="reference internal" href="arithlang.html">A language for arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine.html">A mental model for the machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="notional-machine.html">Notional machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="growing.html">Growing the language</a></li>
<li class="toctree-l1"><a class="reference internal" href="fun.html">Functions and scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="fun-arith.html">Functions and scope (arithmetic track)</a></li>
<li class="toctree-l1"><a class="reference internal" href="stacks-and-scope.html">Stacks and scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="fun-in-piclang.html">Functions in PicLang</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutations.html">Mutations</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators.html">Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="errornot.html">On the choice between “error” and “do something reasonable” in design</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Polymorphism via dispatch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#exploring-through-property-lists">Exploring through “property lists”</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-prototype-based-object-system">A prototype based object system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#it-s-tiring">It’s tiring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-methods">Class methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classes-and-types">Classes and Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uniformity-considerations">Uniformity considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flipping-things-around">Flipping things around</a></li>
<li class="toctree-l2"><a class="reference internal" href="#miscellaneous-considerations">Miscellaneous considerations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appsem.html">Alternative application semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Types: Checking some program invariants statically</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="errornot.html" title="previous chapter">On the choice between “error” and “do something reasonable” in design</a></li>
      <li>Next: <a href="appsem.html" title="next chapter">Alternative application semantics</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022, Srikumar K. S..
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/dispatch.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>